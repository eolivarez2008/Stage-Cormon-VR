<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Accueil Spatial</title>
  <link rel="shortcut icon" href="../CCC.svg" type="image/svg+xml">
  <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
  <script>
    if (window.AFRAME && AFRAME.THREE) window.THREE = AFRAME.THREE;
  </script>
</head>
<body>

<a-scene shadow="type: pcfsoft">

  <a-assets>
    <!-- ModÃ¨les 3D -->
    <a-asset-item id="cratere" src="../objects-glb/cratere.glb"></a-asset-item>
    <a-asset-item id="portailModel" src="../objects-glb/portal-animated.glb"></a-asset-item>
    <a-asset-item id="pad" src="../objects-glb/round_platform.glb"></a-asset-item>
    <a-asset-item id="piedestal" src="../objects-glb/rotating_light_platform_final.glb"></a-asset-item>
    <a-asset-item id="rochet" src="../objects-glb/roc.glb"></a-asset-item>
    <a-asset-item id="moon" src="../objects-glb/moon.glb"></a-asset-item>
    <a-asset-item id="shootingStarModel" src="../objects-glb"></a-asset-item>

    <!-- VidÃ©o -->
    <video id="CART_SECRET" loop="true" preload="auto" src="../videos/cart.mp4"></video>

    <!-- Sons -->
    <audio id="gaspSound" src="../songs/gasp-6253.mp3" preload="auto"></audio>
    <audio id="rumbleSound" src="../songs/earth-rumble-6953.mp3" preload="auto"></audio>
    <audio id="finalSound" src="../songs/male-ahhhh-104524.mp3" preload="auto"></audio>

    <!-- Images -->
    <img id="portal1" src="../images/informatique.jpg">
    <img id="portal2" src="../images/cyber.jpg">
    <img id="portal3" src="../images/iot.jpg">
    <img id="portal4" src="../images/cormon.jpg">
    <img id="portal5" src="../images/electronique.jpg">
    <img id="portal6" src="../images/reseau.jpg">
  </a-assets>

  <!-- Sky -->
  <a-sky src="../background/space.jpg"></a-sky>

  <!-- LumiÃ¨re principale -->
    <a-entity light="intensity: 1.2; castShadow: true; shadowCameraFar: 200; shadowCameraNear: 0.1; shadowCameraTop: 21.76; shadowCameraRight: 27.76; shadowCameraBottom: -28.95; shadowCameraLeft: -30.55" position="0.67485 15 22.6312"></a-entity>
    <a-entity light="type: ambient; intensity: 0.4; color: #ffffff"></a-entity>

  <!-- CratÃ¨re -->
  <a-gltf-model id="cratereModel" src="#cratere" position="-1.52205 -3.25 -3.97696" scale="0.02 0.02 0.02" shadow="" gltf-model="../objects-glb/cratere.glb"></a-gltf-model>

  <!-- Pad -->
  <a-gltf-model id="pad-sol" src="#pad" position="0 -0.24 0" rotation="0 0 0" scale="4 4 4" shadow="receive: true"></a-gltf-model>

  <!-- Piedestal -->
  <a-gltf-model id="piedestalModel" src="#piedestal" position="0 -0.12 0" rotation="0 0 0" scale="0.08 0.08 0.08" shadow="cast: true; receive: true"></a-gltf-model>

    <!-- Portails -->
    <a-entity id="portails">
        <!-- Portail 1 : Informatique -->
        <a-gltf-model src="#portailModel" position="0.37749 -0.0186 7.31305" rotation="0 180 0" scale="1.7 1.7 1.7" animation-mixer shadow="cast: true; receive: true">
            <a-circle class="portal-clickable" data-key="informatique" radius="0.9" position="0 1 0" material="shader: flat; src: #portal1; side: double"></a-circle>
            <a-text value="Informatique" look-at="[camera]" position="0 0.25 0.28" align="center" color="#b5b5b5" width="3" font="https://cdn.aframe.io/fonts/Exo2Bold.fnt"></a-text>
        </a-gltf-model>

        <!-- Portail 2 : CybersÃ©curitÃ© -->
        <a-gltf-model src="#portailModel" position="6.39154 0 3.83122" rotation="0 -118.71 0" scale="1.7 1.7 1.7" animation-mixer shadow="cast: true; receive: true">
            <a-circle class="portal-clickable" data-key="cybersecurite" radius="0.9" position="0 1 0" material="shader: flat; src: #portal2; side: double"></a-circle>
            <a-text value="Cybersecurite" look-at="[camera]" position="0 0.25 0.28" align="center" color="#b5b5b5" width="4" font="https://cdn.aframe.io/fonts/Exo2Bold.fnt"></a-text>
        </a-gltf-model>

        <!-- Portail 3 : IOT -->
        <a-gltf-model src="#portailModel" position="-6.45748 0.03514 3.76535" rotation="0 118.86 0" scale="1.7 1.7 1.7" animation-mixer shadow="cast: true; receive: true">
            <a-circle class="portal-clickable" data-key="iot" radius="0.9" position="0 1 0" material="shader: flat; src: #portal3; side: double"></a-circle>
            <a-text value="IOT" look-at="[camera]" position="0 0.25 0.28" align="center" color="#b5b5b5" width="3" font="https://cdn.aframe.io/fonts/Exo2Bold.fnt"></a-text>
        </a-gltf-model>

        <!-- Portail 4 : LycÃ©e Cormontaigne -->
        <a-gltf-model src="#portailModel" position="-0.16931 0 -7.49207" scale="1.7 1.7 1.7" animation-mixer shadow="cast: true; receive: true">
            <a-circle class="portal-clickable" data-key="lycee" radius="0.9" position="0 1 0" material="shader: flat; src: #portal4; side: double"></a-circle>
            <a-text value="Lycee Cormontaigne" look-at="[camera]" position="0 0.25 0.28" align="center" color="#b5b5b5" width="3" font="https://cdn.aframe.io/fonts/Exo2Bold.fnt"></a-text>
        </a-gltf-model>

        <!-- Portail 5 : Ã‰lectronique -->
        <a-gltf-model src="#portailModel" position="-6.34921 0 -3.93704" rotation="0 57.51 0" scale="1.7 1.7 1.7" animation-mixer shadow="cast: true; receive: true">
            <a-circle class="portal-clickable" data-key="electronique" radius="0.9" position="0 1 0" material="shader: flat; src: #portal5; side: double"></a-circle>
            <a-text value="Electronique" look-at="[camera]" position="0 0.25 0.28" align="center" color="#b5b5b5" width="3" font="https://cdn.aframe.io/fonts/Exo2Bold.fnt"></a-text>
        </a-gltf-model>

        <!-- Portail 6 : RÃ©seau -->
        <a-gltf-model src="#portailModel" position="6.27631 0.03611 -3.65596" rotation="0 -56.09 0" scale="1.7 1.7 1.7" animation-mixer shadow="cast: true; receive: true">
            <a-circle class="portal-clickable" data-key="reseau" radius="0.9" position="0 1 0" material="shader: flat; src: #portal6; side: double"></a-circle>
            <a-text value="Reseau" look-at="[camera]" position="0 0.25 0.28" align="center" color="#b5b5b5" width="3" font="https://cdn.aframe.io/fonts/Exo2Bold.fnt"></a-text>
        </a-gltf-model>
    </a-entity>

    <!-- Lune -->
    <a-entity id="moonOrbit" position="0 0 0"
            animation="property: rotation; to: 0 360 0; loop: true; dur: 50000; easing: linear">
        
        <!-- Groupe de la lune -->
        <a-entity id="moonGroup" position="0 40 -80">
            
            <!-- ModÃ¨le de la lune -->
            <a-gltf-model id="moon" 
                        src="#moon"
                        scale="9 9 9"
                        rotation="0 0 0"
                        shadow="cast: true; receive: true">
            </a-gltf-model>

            <!-- ðŸ’¡ LumiÃ¨re principale : la lune Ã©claire la scÃ¨ne -->
            <a-entity id="moonToScene"
                    light="type: directional; intensity: 1.6; color: #f8faff; castShadow: true;
                            shadowCameraFar: 200; shadowCameraTop: 60; shadowCameraBottom: -60;
                            shadowCameraLeft: -60; shadowCameraRight: 60;"
                    position="0 0 0"
                    target="#cratereModel">
            </a-entity>

            <!-- ðŸ’¡ LumiÃ¨re inverse : le cratÃ¨re Ã©claire lÃ©gÃ¨rement la lune (pour quâ€™elle soit visible) -->
            <a-entity id="sceneToMoon"
                    light="type: directional; intensity: 0.9; color: #ffffff;"
                    position="0 -40 80"
                    target="#moon">
            </a-entity>

        </a-entity>
    </a-entity>

  <!-- ROC -->
  <a-entity id="rocOrbit" position="0 0 0" animation="property: rotation; to: 0 360 0; loop: true; dur: 15000; easing: linear">
    <a-gltf-model id="roc" src="#rochet" position="-1.08453 83.98102 -112.02373" scale="2 2 2" animation-mixer="timeScale: 0.2" class="clickable" shadow="cast: true; receive: true"></a-gltf-model>
  </a-entity>

    <!-- VidÃ©o cachÃ©e pour le secret --> 
    <a-video id="cartVideo" src="#CART_SECRET" toggleclick="" position="0.58828 11.74254 -2.11353" visible="false" class="clickable" rotation="89.29375349775343 -179.9998479605043 -179.9998479605043" scale="10 10 1"></a-video>

  <!-- Camera -->
    <a-camera position="0 1.6 0" wasd-controls="enabled: false">
    <a-entity cursor="rayOrigin: mouse" raycaster="objects: .clickable, .portal-clickable"></a-entity>
    </a-camera>

    <!-- Popup -->
    <div id="popup" style="display:none;">
        <button id="closePopup">X</button>
        <div id="popupContent"></div>
    </div>

  <button id="btn-home">Accueil</button>

</a-scene>

<script type="module" src="../scripts/bac-ciel.js"></script>
<script>
// Bouton Accueil
document.getElementById('btn-home').addEventListener('click', () => {
  window.location.href = '../';
});
</script>

<style>
#popup {
  position: fixed;
  top: 5%;
  left: 5%;
  width: 90%;
  height: 90%;
  background-color: rgba(0,0,0,0.95);
  color: white;
  border-radius: 10px;
  padding: 20px;
  z-index: 2000;
  overflow-y: auto;
  box-shadow: 0 0 20px #000;
}
#closePopup {
  position: absolute;
  top: 15px;
  right: 20px;
  background: red;
  color: white;
  border: none;
  font-size: 18px;
  border-radius: 5px;
  cursor: pointer;
}
#popupContent { margin-top: 50px; }
#btn-home {
    position: fixed;      
    top: 20px;   
    right: 20px;      
    background-color: rgba(0, 0, 0, 0.6); 
    color: white;
    border: none;
    padding: 10px 15px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 14px;
    z-index: 1000;       
    transition: background-color 0.3s;
}

#btn-home:hover { background-color: rgba(0, 0, 0, 0.85); }
</style>

</body>
</html>
